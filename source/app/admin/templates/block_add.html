<?php 
defined('IN_DC') or exit('Access Denied');
include atpl('header');
?>



{$menu}
    <div class="space">
        <div class="subtitle">添加碎片</div>


<form action="?file=<?=$file?>&action=<?=$action?>" method="post" name="myform">
<input type="hidden" name="forward" value="<?=$forward?>"> 
<table class="maintable" border="0" cellspacing="0" cellpadding="0">
      <td width="30%"><font color="red">*</font> <b>碎片名称</b></td>
      <td><input type="text" name="info[name]" size="50" require="true" datatype="limit" min="2" max="20" msg="碎片名称不得少于2个字符超过20个字符！"></td>
    </tr>
	<tr> 
      <td><font color="red">*</font> <b>网页标识</b><br />调用碎片页面的网页标识（pageid）</td>
      <td><input type="text" name="info[pageid]" id="pageid" size="20" value="<?=$pageid?>" maxlength="20" require="true" datatype="limit|ajax" url="?file=<?=$file?>&action=check" min="1" max="20" msg="网页标识不得少于1个字符超过20个字符！|"></td>
    </tr>

	<tr> 
      <td><font color="red">*</font> <b>数据格式</b></td>
      <td>
	  <input type="radio" name="info[isarray]" id="isarray" value="1" checked onclick="$('#data_rows').show();"> 格式化（输入标题、缩略图、简介、日期、链接）<br/>
	  <input type="radio" name="info[isarray]" id="isarray" value="0" onclick="$('#data_rows').hide();"> 非格式化（输入html代码）
	  </td>
    </tr>
	<tbody id="data_rows" style="display:">
	<tr> 
      <td><font color="red">*</font> <b>数据行数</b></td>
      <td><input type="text" name="info[rows]" id="rows" size="5" value="6" require="true" datatype="integer" msg="请输入整数！"> 行</td>
    </tr>
	<tr> 
      <td><font color="red">*</font> <b>默认模板代码</b></td>
      <td>
<textarea name="info[template]" id="template" style="width:100%;height:120px;">
<h4>&#123;$name&#125;</h4>
<ul>
&#123;loop $data $n $r&#125;
   <li><a href="{$r[url]}">&#123;str_cut($r[title], 40)&#125; &#123;$r[date]&#125;</a></li>
&#123;/loop&#125;
</ul>

</textarea>
	<span style="height:25px"><input type="button" value="&#123;loop *&#125;" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;loop $data $n $r&#125;')" /></span>
	<span style="height:25px"><input type="button" value="&#123;/loop&#125;" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;/loop&#125;')" /></span>
	<span style="height:25px"><input type="button" value="碎片名称" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$name&#125;')" /></span>
	<span style="height:25px"><input type="button" value="标题" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$r[title]&#125;')" /></span>
	<span style="height:25px"><input type="button" value="URL" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$r[url]&#125;')" /></span>
	<span style="height:25px"><input type="button" value="缩略图" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$r[thumb]&#125;')" /></span>
	<span style="height:25px"><input type="button" value="日期" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$r[date]&#125;')" /></span>
	<span style="height:25px"><input type="button" value="简介" title="点击插入" style="width:60px" onClick="javascript:insertText('&#123;$r[description]&#125;')" /></span>
    
    
      </td>
    </tr>
	</tbody>

    <tr> 
      <td></td>
      <td> 
      <input type="submit" name="dosubmit" value=" 下一步 "> 
      &nbsp; <input type="reset" name="reset" value=" 清除 ">
      
	  </td>
    </tr>
</table>
</form>
<script type="text/javascript">
$().ready(function(){
	$('form').checkForm(1);
});

function insertText(text)
{
	myform.template.focus();
    var str = document.selection.createRange();
	str.text = text;
}

</script>
</div>
</body>
</html>