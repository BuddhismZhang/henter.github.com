
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>通过dotcloud代替localtunnel建立本地服务器 | Henter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="Henter" />
    <meta name="keywords" content="henter, henter个人博客" />
    <meta name="description" content="Henter's personal site, focus on the web." />
    <link rel="stylesheet" href="/css/henter-diandian.css" type="text/css" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/top.js"></script>
</head>
<body>


<div id="container" class="clear">

    <div class="left viewport" id="left-cont">
        <div class="overview" style="left:0;top:0;">
            
            <div class="logo">
                <a href="/">
                    <span class="logo-mark">
                        <img src="/images/avatar.jpg" />
                    </span>
                </a>
            </div>
            
            <div class="blog-name"><a href="/">Henter</a></div>
            <p class="blog-desc">
                RD at <a href="http://zuo.com/@henter" target="_blank">zuo.com</a>

                <br /><br />
                E-mail: <a href="mailto: henter@henter.me" target="_blank">henter@henter.me</a> <br />
                Weibo: <a href="http://weibo.com/henter" target="_blank">@henter</a>
            </p>
            <ul class="nav">
                <li><a href="/about.html">About</a></li>
                <li><a href="/tags.html">Tags</a></li>
                <li><a href="/archive.html">Archive</a></li>
                <li><a href="/atom.xml">RSS</a></li>
            </ul>
            
            <div class="music">
                <object type="application/x-shockwave-flash" data="/images/music.swf" width="150" height="24" id="fancyplayer" name="fancyplayer">
                    <param name="wmode" value="transparent"></param>
                    <param name="movie" value="/images/music.swf"></param>
                    <param name="flashvars" value="mp3=http://a.libdd.com/farm1/19/53EAEE74712880DBF40B0A7915561C13.mp3&amp;"></param>
                </object>
            </div>
            
            <div id="footer">
                &copy; Henter <br />
                2008 - 2013
            </div>

            <span class="arrow"></span>
        </div>
    </div>

    <div class="right">
        <div class="content">
            <article class="post">
    <h1 class="post-title">通过dotcloud代替localtunnel建立本地服务器</h1>
    <p>安装dotcloud cli</p>

<pre><code>sudo easy_install pip &amp;&amp; sudo pip install dotcloud

dotcloud setup
</code></pre>

<p>PS：我按以上步骤安装完后 <code>dotcloud</code>不能直接用</p>

<p>需要用 <code>/usr/local/share/python/dotcloud</code>代替</p>

<p>当然，你也可以用软链</p>

<pre><code>ln -s /usr/local/share/python/dotcloud /usr/local/bin/dotcloud
</code></pre>

<p>安装完dotcloud cli工具后，开始建立webapp，以<code>webtunnel</code>为例</p>

<p>先从github clone一个配置</p>

<pre><code>git clone https://github.com/3on/tunnel-on-dotcloud.git
cd tunnel-on-dotcloud/
</code></pre>

<p>注：这个repo里面有个地方写错了，默认是无法直接运行的，修改如下</p>

<p>打开 <code>www/nginx.conf</code>文件，在root这一行（第7行）尾部加一个分号<code>;</code></p>

<p>然后</p>

<pre><code>dotcloud create webtunnel
</code></pre>

<p>这个命令会提示<code>Connect the current directory to "webtunnel"?</code>，是否以当前目录做为app目录
也可以用下面这个命令手动执行</p>

<pre><code>dotcloud connect webtunnel
</code></pre>

<p>然后，push到dotcloud服务器</p>

<pre><code>dotcloud push
</code></pre>

<p>然后打开 http://webtunnel-你的用户名.dotcloud.com</p>

<p>部署成功的话会显示 <code>www/index.html</code>的内容</p>

<pre><code>Grab host url


    dotcloud info tunnel.proxy
</code></pre>

<p>如果提示“Application Not Responding”，表示部署失败，检查问题重新部署。</p>

<p>然后，查看proxy信息</p>

<pre><code>`dotcloud info proxy`
</code></pre>

<p>过程如下</p>

<pre><code>➜$ dotcloud info proxy
== proxy
type:            static
instances:       1
reserved memory: N/A
URLs:
  - http://webtunnel-henter.dotcloud.com

=== proxy.0
datacenter:       Amazon-us-east-1d
service revision: static/da4d1ea2eec9 (latest revision)
revision:         rsync-1363850353553
ports:
  ssh: ssh://dotcloud@webtunnel-henter.azva.dotcloud.net:22481
</code></pre>

<p>开启本地服务器，如果没安装apache nginx等web服务器，可以用python开启一个简易服务器</p>

<pre><code>$ python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...
</code></pre>

<p>最后，通过ssh链接dotcloud，注意连接格式把里面的host和8000（本地web服务器端口）改成你自己的。</p>

<pre><code>ssh -i ~/.dotcloud_cli/dotcloud.key -l dotcloud -p 22481 webtunnel-henter.azva.dotcloud.net -R 8042:localhost:8000
</code></pre>

<p>参考</p>

<pre><code>http://blog.dotcloud.com/open-your-local-webapp-to-the-web-with-dotclo
https://github.com/3on/tunnel-on-dotcloud
http://docs.dotcloud.com/guides/flavors/
http://docs.dotcloud.com/firststeps/install/
</code></pre>

    <div class="tags">dotcloudlocaltunnel云平台</div>
    <nav class="pagination-link">
        
        <a class="prev" href="/post/cubieboard-test.html" rel="bookmark">&laquo;&nbsp;Cubieboard开发版测试</a>
        
        
        <a class="next" href="/post/php-fatal-error-maximum-function-nesting-level-of-100-reached.html" rel="bookmark">解决PHP Maximum function nesting level...&nbsp;&raquo;</a>
        
     </nav>
     <div id="disqus_thread"></div>
</article>  

            <div class="hr2"></div>
        </div>
    </div>
    
    <a class="fork-me" href="https://github.com/henter/henter.github.com" target="_blank" rel="nofollow">
        <img src="images/forkme.png" alt="Fork me on GitHub">
    </a>

</div>

<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F63bcd6253465d79c553673d7f2d28b3d' type='text/javascript'%3E%3C/script%3E"));
</script>

</body>
</html>
